(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     48022,       1421]
NotebookOptionsPosition[     47693,       1407]
NotebookOutlinePosition[     48065,       1423]
CellTagsIndexPosition[     48022,       1420]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Q1", "[", 
     RowBox[{"p_", ",", "UA_", ",", "UB_", ",", "UC_", ",", "d_", ",", "e_"}],
      "]"}], ":=", 
    RowBox[{"Det", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"p", "*", 
           RowBox[{"e", "/", "d"}]}], "+", 
          RowBox[{"1", "/", "d"}], "-", 
          RowBox[{"e", "/", "d"}], "+", "1", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "d"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"1", "-", "d"}], ")"}]}]}], ",", 
         RowBox[{
          RowBox[{"-", "1"}], "/", "d"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "/", "d"}], ",", 
         RowBox[{
          RowBox[{"p", "*", 
           RowBox[{"d", "/", "e"}]}], "+", 
          RowBox[{"1", "/", "d"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"d", "^", "2"}], "+", "e"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"d", "-", 
             RowBox[{"d", "*", "e"}]}], ")"}]}]}]}], "}"}]}], "}"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Q2", "[", 
     RowBox[{"p_", ",", "UA_", ",", "UB_", ",", "UC_", ",", "d_", ",", "e_"}],
      "]"}], ":=", 
    RowBox[{"Det", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"e", "*", "UA", "*", 
           RowBox[{"p", "/", "d"}]}], "-", 
          RowBox[{"e", "*", 
           RowBox[{"UC", "/", "d"}]}], "+", "UC", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "d"}], ")"}], "*", 
           RowBox[{"UB", "/", 
            RowBox[{"(", 
             RowBox[{"1", "-", "d"}], ")"}]}]}]}], ",", 
         RowBox[{
          RowBox[{"-", "1"}], "/", "d"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"UA", "*", "d", "*", 
           RowBox[{"p", "/", "e"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"d", "^", "2"}], "+", "e"}], ")"}], "*", 
           RowBox[{"UC", "/", 
            RowBox[{"(", 
             RowBox[{"d", "-", 
              RowBox[{"d", "*", "e"}]}], ")"}]}]}]}], ",", 
         RowBox[{
          RowBox[{"p", "*", 
           RowBox[{"d", "/", "e"}]}], "+", 
          RowBox[{"1", "/", "d"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"d", "^", "2"}], "+", "e"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"d", "-", 
             RowBox[{"d", "*", "e"}]}], ")"}]}]}]}], "}"}]}], "}"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Q3", "[", 
     RowBox[{"p_", ",", "UA_", ",", "UB_", ",", "UC_", ",", "d_", ",", "e_"}],
      "]"}], ":=", 
    RowBox[{"Det", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"p", "*", 
           RowBox[{"e", "/", "d"}]}], "+", 
          RowBox[{"1", "/", "d"}], "-", 
          RowBox[{"e", "/", "d"}], "+", "1", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "d"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"1", "-", "d"}], ")"}]}]}], ",", 
         RowBox[{
          RowBox[{"e", "*", "UA", "*", 
           RowBox[{"p", "/", "d"}]}], "-", 
          RowBox[{"e", "*", 
           RowBox[{"UC", "/", "d"}]}], "+", "UC", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "d"}], ")"}], "*", 
           RowBox[{"UB", "/", 
            RowBox[{"(", 
             RowBox[{"1", "-", "d"}], ")"}]}]}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "/", "d"}], ",", 
         RowBox[{
          RowBox[{"UA", "*", "d", "*", 
           RowBox[{"p", "/", "e"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"d", "^", "2"}], "+", "e"}], ")"}], "*", 
           RowBox[{"UC", "/", 
            RowBox[{"(", 
             RowBox[{"d", "-", 
              RowBox[{"d", "*", "e"}]}], ")"}]}]}]}]}], "}"}]}], "}"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Q4", "[", 
     RowBox[{"p_", ",", "UA_", ",", "UB_", ",", "UC_", ",", "d_", ",", "e_"}],
      "]"}], ":=", 
    RowBox[{"Det", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"p", "*", 
           RowBox[{"e", "/", "d"}]}], "+", 
          RowBox[{"1", "/", "e"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"e", "^", "2"}], "+", "d"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"e", "-", 
             RowBox[{"e", "*", "d"}]}], ")"}]}]}], ",", 
         RowBox[{
          RowBox[{"-", "1"}], "/", "e"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "/", "e"}], ",", 
         RowBox[{
          RowBox[{"p", "*", 
           RowBox[{"d", "/", "e"}]}], "+", 
          RowBox[{"1", "/", "e"}], "-", 
          RowBox[{"d", "/", "e"}], "+", "1", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "e"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"1", "-", "e"}], ")"}]}]}]}], "}"}]}], "}"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Q5", "[", 
     RowBox[{"p_", ",", "UA_", ",", "UB_", ",", "UC_", ",", "d_", ",", "e_"}],
      "]"}], ":=", 
    RowBox[{"Det", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"p", "*", 
           RowBox[{"e", "/", "d"}], "*", "UA"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"e", "^", "2"}], "+", "d"}], ")"}], "*", 
           RowBox[{"UB", "/", 
            RowBox[{"(", 
             RowBox[{"e", "-", 
              RowBox[{"e", "*", "d"}]}], ")"}]}]}]}], ",", 
         RowBox[{
          RowBox[{"-", "1"}], "/", "e"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"p", "*", "d", "*", 
           RowBox[{"UA", "/", "e"}]}], "-", 
          RowBox[{"d", "*", 
           RowBox[{"UB", "/", "e"}]}], "+", "UB", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "e"}], ")"}], "*", 
           RowBox[{"UC", "/", 
            RowBox[{"(", 
             RowBox[{"1", "-", "e"}], ")"}]}]}]}], ",", 
         RowBox[{
          RowBox[{"p", "*", 
           RowBox[{"d", "/", "e"}]}], "+", 
          RowBox[{"1", "/", "e"}], "-", 
          RowBox[{"d", "/", "e"}], "+", "1", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "e"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"1", "-", "e"}], ")"}]}]}]}], "}"}]}], "}"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Q6", "[", 
    RowBox[{"p_", ",", "UA_", ",", "UB_", ",", "UC_", ",", "d_", ",", "e_"}], 
    "]"}], ":=", 
   RowBox[{"Det", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"p", "*", 
          RowBox[{"e", "/", "d"}]}], "+", 
         RowBox[{"1", "/", "e"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"e", "^", "2"}], "+", "d"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"e", "-", 
            RowBox[{"e", "*", "d"}]}], ")"}]}]}], ",", 
        RowBox[{
         RowBox[{"p", "*", 
          RowBox[{"e", "/", "d"}], "*", "UA"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"e", "^", "2"}], "+", "d"}], ")"}], "*", 
          RowBox[{"UB", "/", 
           RowBox[{"(", 
            RowBox[{"e", "-", 
             RowBox[{"e", "*", "d"}]}], ")"}]}]}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "/", "e"}], ",", 
        RowBox[{
         RowBox[{"p", "*", "d", "*", 
          RowBox[{"UA", "/", "e"}]}], "-", 
         RowBox[{"d", "*", 
          RowBox[{"UB", "/", "e"}]}], "+", "UB", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", "e"}], ")"}], "*", 
          RowBox[{"UC", "/", 
           RowBox[{"(", 
            RowBox[{"1", "-", "e"}], ")"}]}]}]}]}], "}"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UD", "[", 
    RowBox[{"p_", ",", "UA_", ",", "UB_", ",", "UC_", ",", "d_", ",", "e_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"Q2", "[", 
     RowBox[{"p", ",", "UA", ",", "UB", ",", "UC", ",", "d", ",", "e"}], 
     "]"}], "/", 
    RowBox[{"Q1", "[", 
     RowBox[{"p", ",", "UA", ",", "UB", ",", "UC", ",", "d", ",", "e"}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UE", "[", 
    RowBox[{"p_", ",", "UA_", ",", "UB_", ",", "UC_", ",", "d_", ",", "e_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"Q3", "[", 
     RowBox[{"p", ",", "UA", ",", "UB", ",", "UC", ",", "d", ",", "e"}], 
     "]"}], "/", 
    RowBox[{"Q1", "[", 
     RowBox[{"p", ",", "UA", ",", "UB", ",", "UC", ",", "d", ",", "e"}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"phiAofD", "[", 
    RowBox[{"p_", ",", "d_", ",", "e_"}], "]"}], ":=", 
   RowBox[{"UD", "[", 
    RowBox[{"p", ",", "1", ",", "0", ",", "0", ",", "d", ",", "e"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"phiAofE", "[", 
    RowBox[{"p_", ",", "d_", ",", "e_"}], "]"}], ":=", 
   RowBox[{"UE", "[", 
    RowBox[{"p", ",", "1", ",", "0", ",", "0", ",", "d", ",", "e"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"phiBofD", "[", 
    RowBox[{"p_", ",", "d_", ",", "e_"}], "]"}], ":=", 
   RowBox[{"UD", "[", 
    RowBox[{"p", ",", "0", ",", "1", ",", "0", ",", "d", ",", "e"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"phiBofE", "[", 
    RowBox[{"p_", ",", "d_", ",", "e_"}], "]"}], ":=", 
   RowBox[{"UE", "[", 
    RowBox[{"p", ",", "0", ",", "1", ",", "0", ",", "d", ",", "e"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"phiCofD", "[", 
    RowBox[{"p_", ",", "d_", ",", "e_"}], "]"}], ":=", 
   RowBox[{"UD", "[", 
    RowBox[{"p", ",", "0", ",", "0", ",", "1", ",", "d", ",", "e"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"phiCofE", "[", 
    RowBox[{"p_", ",", "d_", ",", "e_"}], "]"}], ":=", 
   RowBox[{"UE", "[", 
    RowBox[{"p", ",", "0", ",", "0", ",", "1", ",", "d", ",", "e"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Atau", "[", 
   RowBox[{"c1_", ",", "c2_", ",", "c3_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"c2", "+", "c3"}], ",", 
       RowBox[{"-", "c3"}], ",", 
       RowBox[{"-", "c2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "c3"}], ",", 
       RowBox[{"c3", "+", "c1"}], ",", 
       RowBox[{"-", "c1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "c2"}], ",", 
       RowBox[{"-", "c1"}], ",", 
       RowBox[{"c1", "+", "c2"}]}], "}"}]}], "}"}], "/", 
   "2"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FEM1", "[", 
    RowBox[{"d_", ",", "e_"}], "]"}], ":=", 
   RowBox[{"Atau", "[", 
    RowBox[{"0", ",", 
     RowBox[{"d", "/", "e"}], ",", 
     RowBox[{"e", "/", "d"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FEM2", "[", 
    RowBox[{"d_", ",", "e_"}], "]"}], ":=", 
   RowBox[{"Atau", "[", 
    RowBox[{
     RowBox[{"1", "/", "d"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"d", "^", "2"}], "+", "e"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"d", "-", 
        RowBox[{"d", "*", "e"}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"-", "e"}], "/", "d"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FEM3", "[", 
    RowBox[{"d_", ",", "e_"}], "]"}], ":=", 
   RowBox[{"Atau", "[", 
    RowBox[{"1", ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", "d"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"1", "-", "d"}], ")"}]}], ",", 
     RowBox[{"-", "d"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FEM4", "[", 
    RowBox[{"d_", ",", "e_"}], "]"}], ":=", 
   RowBox[{"Atau", "[", 
    RowBox[{"0", ",", 
     RowBox[{"d", "/", "e"}], ",", 
     RowBox[{"e", "/", "d"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FEM5", "[", 
    RowBox[{"d_", ",", "e_"}], "]"}], ":=", 
   RowBox[{"Atau", "[", 
    RowBox[{
     RowBox[{"1", "/", "e"}], ",", 
     RowBox[{
      RowBox[{"-", "d"}], "/", "e"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"e", "^", "2"}], "+", "d"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"e", "-", 
        RowBox[{"e", "*", "d"}]}], ")"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FEM6", "[", 
     RowBox[{"d_", ",", "e_"}], "]"}], ":=", 
    RowBox[{"Atau", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "e"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"1", "-", "e"}], ")"}]}], ",", "1", ",", 
      RowBox[{"-", "e"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AdotA", "[", 
    RowBox[{"p_", ",", "d_", ",", "e_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"p", "*", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"phiAofD", "[", 
          RowBox[{"p", ",", "d", ",", "e"}], "]"}], ",", 
         RowBox[{"phiAofE", "[", 
          RowBox[{"p", ",", "d", ",", "e"}], "]"}]}], "}"}], "}"}], ".", 
      RowBox[{"FEM1", "[", 
       RowBox[{"d", ",", "e"}], "]"}], ".", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "1", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"phiAofD", "[", 
          RowBox[{"p", ",", "d", ",", "e"}], "]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"phiAofE", "[", 
          RowBox[{"p", ",", "d", ",", "e"}], "]"}], "}"}]}], "}"}]}]}], "+", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"phiAofD", "[", 
         RowBox[{"p", ",", "d", ",", "e"}], "]"}], ",", 
        RowBox[{"phiAofE", "[", 
         RowBox[{"p", ",", "d", ",", "e"}], "]"}]}], "}"}], "}"}], ".", 
     RowBox[{"FEM2", "[", 
      RowBox[{"d", ",", "e"}], "]"}], ".", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"phiAofD", "[", 
         RowBox[{"p", ",", "d", ",", "e"}], "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"phiAofE", "[", 
         RowBox[{"p", ",", "d", ",", "e"}], "]"}], "}"}]}], "}"}]}], "+", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        RowBox[{"phiAofD", "[", 
         RowBox[{"p", ",", "d", ",", "e"}], "]"}]}], "}"}], "}"}], ".", 
     RowBox[{"FEM3", "[", 
      RowBox[{"d", ",", "e"}], "]"}], ".", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"phiAofD", "[", 
         RowBox[{"p", ",", "d", ",", "e"}], "]"}], "}"}]}], "}"}]}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BdotB", "[", 
    RowBox[{"p_", ",", "d_", ",", "e_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"p", "*", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"phiBofD", "[", 
          RowBox[{"p", ",", "d", ",", "e"}], "]"}], ",", 
         RowBox[{"phiBofE", "[", 
          RowBox[{"p", ",", "d", ",", "e"}], "]"}]}], "}"}], "}"}], ".", 
      RowBox[{"FEM1", "[", 
       RowBox[{"d", ",", "e"}], "]"}], ".", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "0", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"phiBofD", "[", 
          RowBox[{"p", ",", "d", ",", "e"}], "]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"phiBofE", "[", 
          RowBox[{"p", ",", "d", ",", "e"}], "]"}], "}"}]}], "}"}]}]}], "+", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"phiBofD", "[", 
         RowBox[{"p", ",", "d", ",", "e"}], "]"}], ",", 
        RowBox[{"phiBofE", "[", 
         RowBox[{"p", ",", "d", ",", "e"}], "]"}]}], "}"}], "}"}], ".", 
     RowBox[{"FEM2", "[", 
      RowBox[{"d", ",", "e"}], "]"}], ".", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"phiBofD", "[", 
         RowBox[{"p", ",", "d", ",", "e"}], "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"phiBofE", "[", 
         RowBox[{"p", ",", "d", ",", "e"}], "]"}], "}"}]}], "}"}]}], "+", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", 
        RowBox[{"phiBofD", "[", 
         RowBox[{"p", ",", "d", ",", "e"}], "]"}]}], "}"}], "}"}], ".", 
     RowBox[{"FEM3", "[", 
      RowBox[{"d", ",", "e"}], "]"}], ".", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1", "}"}], ",", 
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"phiBofD", "[", 
         RowBox[{"p", ",", "d", ",", "e"}], "]"}], "}"}]}], "}"}]}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CdotC", "[", 
    RowBox[{"p_", ",", "d_", ",", "e_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"p", "*", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"phiCofD", "[", 
          RowBox[{"p", ",", "d", ",", "e"}], "]"}], ",", 
         RowBox[{"phiCofE", "[", 
          RowBox[{"p", ",", "d", ",", "e"}], "]"}]}], "}"}], "}"}], ".", 
      RowBox[{"FEM1", "[", 
       RowBox[{"d", ",", "e"}], "]"}], ".", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "0", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"phiCofD", "[", 
          RowBox[{"p", ",", "d", ",", "e"}], "]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"phiCofE", "[", 
          RowBox[{"p", ",", "d", ",", "e"}], "]"}], "}"}]}], "}"}]}]}], "+", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"phiCofD", "[", 
         RowBox[{"p", ",", "d", ",", "e"}], "]"}], ",", 
        RowBox[{"phiCofE", "[", 
         RowBox[{"p", ",", "d", ",", "e"}], "]"}]}], "}"}], "}"}], ".", 
     RowBox[{"FEM2", "[", 
      RowBox[{"d", ",", "e"}], "]"}], ".", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"phiCofD", "[", 
         RowBox[{"p", ",", "d", ",", "e"}], "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"phiCofE", "[", 
         RowBox[{"p", ",", "d", ",", "e"}], "]"}], "}"}]}], "}"}]}], "+", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", 
        RowBox[{"phiCofD", "[", 
         RowBox[{"p", ",", "d", ",", "e"}], "]"}]}], "}"}], "}"}], ".", 
     RowBox[{"FEM3", "[", 
      RowBox[{"d", ",", "e"}], "]"}], ".", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "1", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"phiCofD", "[", 
         RowBox[{"p", ",", "d", ",", "e"}], "]"}], "}"}]}], "}"}]}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AdotB", "[", 
    RowBox[{"p_", ",", "d_", ",", "e_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"p", "*", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"phiAofD", "[", 
          RowBox[{"p", ",", "d", ",", "e"}], "]"}], ",", 
         RowBox[{"phiAofE", "[", 
          RowBox[{"p", ",", "d", ",", "e"}], "]"}]}], "}"}], "}"}], ".", 
      RowBox[{"FEM1", "[", 
       RowBox[{"d", ",", "e"}], "]"}], ".", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "0", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"phiBofD", "[", 
          RowBox[{"p", ",", "d", ",", "e"}], "]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"phiBofE", "[", 
          RowBox[{"p", ",", "d", ",", "e"}], "]"}], "}"}]}], "}"}]}]}], "+", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"phiAofD", "[", 
         RowBox[{"p", ",", "d", ",", "e"}], "]"}], ",", 
        RowBox[{"phiAofE", "[", 
         RowBox[{"p", ",", "d", ",", "e"}], "]"}]}], "}"}], "}"}], ".", 
     RowBox[{"FEM2", "[", 
      RowBox[{"d", ",", "e"}], "]"}], ".", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"phiBofD", "[", 
         RowBox[{"p", ",", "d", ",", "e"}], "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"phiBofE", "[", 
         RowBox[{"p", ",", "d", ",", "e"}], "]"}], "}"}]}], "}"}]}], "+", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        RowBox[{"phiAofD", "[", 
         RowBox[{"p", ",", "d", ",", "e"}], "]"}]}], "}"}], "}"}], ".", 
     RowBox[{"FEM3", "[", 
      RowBox[{"d", ",", "e"}], "]"}], ".", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1", "}"}], ",", 
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"phiBofD", "[", 
         RowBox[{"p", ",", "d", ",", "e"}], "]"}], "}"}]}], "}"}]}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BdotC", "[", 
    RowBox[{"p_", ",", "d_", ",", "e_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"p", "*", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"phiBofD", "[", 
          RowBox[{"p", ",", "d", ",", "e"}], "]"}], ",", 
         RowBox[{"phiBofE", "[", 
          RowBox[{"p", ",", "d", ",", "e"}], "]"}]}], "}"}], "}"}], ".", 
      RowBox[{"FEM1", "[", 
       RowBox[{"d", ",", "e"}], "]"}], ".", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "0", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"phiCofD", "[", 
          RowBox[{"p", ",", "d", ",", "e"}], "]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"phiCofE", "[", 
          RowBox[{"p", ",", "d", ",", "e"}], "]"}], "}"}]}], "}"}]}]}], "+", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"phiBofD", "[", 
         RowBox[{"p", ",", "d", ",", "e"}], "]"}], ",", 
        RowBox[{"phiBofE", "[", 
         RowBox[{"p", ",", "d", ",", "e"}], "]"}]}], "}"}], "}"}], ".", 
     RowBox[{"FEM2", "[", 
      RowBox[{"d", ",", "e"}], "]"}], ".", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"phiCofD", "[", 
         RowBox[{"p", ",", "d", ",", "e"}], "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"phiCofE", "[", 
         RowBox[{"p", ",", "d", ",", "e"}], "]"}], "}"}]}], "}"}]}], "+", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", 
        RowBox[{"phiBofD", "[", 
         RowBox[{"p", ",", "d", ",", "e"}], "]"}]}], "}"}], "}"}], ".", 
     RowBox[{"FEM3", "[", 
      RowBox[{"d", ",", "e"}], "]"}], ".", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "1", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"phiCofD", "[", 
         RowBox[{"p", ",", "d", ",", "e"}], "]"}], "}"}]}], "}"}]}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CdotA", "[", 
   RowBox[{"p_", ",", "d_", ",", "e_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"p", "*", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"phiCofD", "[", 
         RowBox[{"p", ",", "d", ",", "e"}], "]"}], ",", 
        RowBox[{"phiCofE", "[", 
         RowBox[{"p", ",", "d", ",", "e"}], "]"}]}], "}"}], "}"}], ".", 
     RowBox[{"FEM1", "[", 
      RowBox[{"d", ",", "e"}], "]"}], ".", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"phiAofD", "[", 
         RowBox[{"p", ",", "d", ",", "e"}], "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"phiAofE", "[", 
         RowBox[{"p", ",", "d", ",", "e"}], "]"}], "}"}]}], "}"}]}]}], "+", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"phiCofD", "[", 
        RowBox[{"p", ",", "d", ",", "e"}], "]"}], ",", 
       RowBox[{"phiCofE", "[", 
        RowBox[{"p", ",", "d", ",", "e"}], "]"}]}], "}"}], "}"}], ".", 
    RowBox[{"FEM2", "[", 
     RowBox[{"d", ",", "e"}], "]"}], ".", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "0", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"phiAofD", "[", 
        RowBox[{"p", ",", "d", ",", "e"}], "]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"phiAofE", "[", 
        RowBox[{"p", ",", "d", ",", "e"}], "]"}], "}"}]}], "}"}]}], "+", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", 
       RowBox[{"phiCofD", "[", 
        RowBox[{"p", ",", "d", ",", "e"}], "]"}]}], "}"}], "}"}], ".", 
    RowBox[{"FEM3", "[", 
     RowBox[{"d", ",", "e"}], "]"}], ".", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "0", "}"}], ",", 
      RowBox[{"{", "0", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"phiAofD", "[", 
        RowBox[{"p", ",", "d", ",", "e"}], "]"}], "}"}]}], 
     "}"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ASTAR", "[", 
     RowBox[{"p_", ",", "d_", ",", "e_"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"AdotA", "[", 
          RowBox[{"p", ",", "d", ",", "e"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"AdotB", "[", 
          RowBox[{"p", ",", "d", ",", "e"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"AdotB", "[", 
          RowBox[{"p", ",", "d", ",", "e"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"BdotB", "[", 
          RowBox[{"p", ",", "d", ",", "e"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Now", " ", "compute", " ", "the", " ", "nodal", " ", "IFE", " ", 
    "interpolation"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Den", "[", 
    RowBox[{"p_", ",", "d_", ",", "e_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"p", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"d", "^", "2"}], "+", 
       RowBox[{"e", "^", "2"}]}], ")"}]}], "+", 
    RowBox[{"d", "*", "e", "*", 
     RowBox[{"(", 
      RowBox[{"d", "+", "e"}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{"1", "-", "p"}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"c1A", "[", 
    RowBox[{"p_", ",", "d_", ",", "e_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "p"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"d", "^", "2"}], "+", 
         RowBox[{"e", "^", "2"}]}], ")"}]}], "-", 
      RowBox[{"e", "*", 
       RowBox[{"(", 
        RowBox[{"d", "+", "e"}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", "p"}], ")"}]}]}], ")"}], "/", 
    RowBox[{"Den", "[", 
     RowBox[{"p", ",", "d", ",", "e"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"c2A", "[", 
    RowBox[{"p_", ",", "d_", ",", "e_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "p"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"d", "^", "2"}], "+", 
         RowBox[{"e", "^", "2"}]}], ")"}]}], "-", 
      RowBox[{"d", "*", 
       RowBox[{"(", 
        RowBox[{"d", "+", "e"}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", "p"}], ")"}]}]}], ")"}], "/", 
    RowBox[{"Den", "[", 
     RowBox[{"p", ",", "d", ",", "e"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"c3A", "[", 
    RowBox[{"p_", ",", "d_", ",", "e_"}], "]"}], ":=", 
   RowBox[{"p", "*", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"d", "^", "2"}], "+", 
       RowBox[{"e", "^", "2"}]}], ")"}], "/", 
     RowBox[{"Den", "[", 
      RowBox[{"p", ",", "d", ",", "e"}], "]"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"c1B", "[", 
    RowBox[{"p_", ",", "d_", ",", "e_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"e", "^", "2"}], "*", 
     RowBox[{"(", 
      RowBox[{"1", "-", "d"}], ")"}], "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}], "/", 
      RowBox[{"Den", "[", 
       RowBox[{"p", ",", "d", ",", "e"}], "]"}]}]}], "-", "1"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"c2B", "[", 
    RowBox[{"p_", ",", "d_", ",", "e_"}], "]"}], ":=", 
   RowBox[{"d", "*", "e", "*", 
    RowBox[{"(", 
     RowBox[{"1", "-", "e"}], ")"}], "*", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "p"}], ")"}], "/", 
     RowBox[{"Den", "[", 
      RowBox[{"p", ",", "d", ",", "e"}], "]"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"c3B", "[", 
    RowBox[{"p_", ",", "d_", ",", "e_"}], "]"}], ":=", 
   RowBox[{"d", "*", 
    RowBox[{"e", "^", "2"}], "*", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "p"}], ")"}], "/", 
     RowBox[{"Den", "[", 
      RowBox[{"p", ",", "d", ",", "e"}], "]"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"c1C", "[", 
    RowBox[{"p_", ",", "d_", ",", "e_"}], "]"}], ":=", 
   RowBox[{"d", "*", "e", "*", 
    RowBox[{"(", 
     RowBox[{"1", "-", "d"}], ")"}], "*", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "p"}], ")"}], "/", 
     RowBox[{"Den", "[", 
      RowBox[{"p", ",", "d", ",", "e"}], "]"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"c2C", "[", 
    RowBox[{"p_", ",", "d_", ",", "e_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"d", "^", "2"}], "*", 
     RowBox[{"(", 
      RowBox[{"1", "-", "e"}], ")"}], "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}], "/", 
      RowBox[{"Den", "[", 
       RowBox[{"p", ",", "d", ",", "e"}], "]"}]}]}], "-", "1"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"c3C", "[", 
    RowBox[{"p_", ",", "d_", ",", "e_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"d", "^", "2"}], "*", "e", "*", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "p"}], ")"}], "/", 
     RowBox[{"Den", "[", 
      RowBox[{"p", ",", "d", ",", "e"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Kp", "[", 
    RowBox[{"p_", ",", "d_", ",", "e_"}], "]"}], ":=", 
   RowBox[{"d", "*", 
    RowBox[{"e", "/", "2"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Km", "[", 
     RowBox[{"p_", ",", "d_", ",", "e_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"1", "/", "2"}], "-", 
     RowBox[{"d", "*", 
      RowBox[{"e", "/", "2"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AdotAIF", "[", 
    RowBox[{"p_", ",", "d_", ",", "e_"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"p", "*", "1", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"c1A", "[", 
         RowBox[{"p", ",", "d", ",", "e"}], "]"}], "^", "2"}], "+", 
       RowBox[{
        RowBox[{"c2A", "[", 
         RowBox[{"p", ",", "d", ",", "e"}], "]"}], "^", "2"}]}], ")"}], "*", 
     RowBox[{"Kp", "[", 
      RowBox[{"p", ",", "d", ",", "e"}], "]"}]}], "+", 
    RowBox[{"1", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"-", 
          RowBox[{"c3A", "[", 
           RowBox[{"p", ",", "d", ",", "e"}], "]"}]}], ")"}], "^", "2"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"-", 
          RowBox[{"c3A", "[", 
           RowBox[{"p", ",", "d", ",", "e"}], "]"}]}], ")"}], "^", "2"}]}], 
      ")"}], "*", 
     RowBox[{"Km", "[", 
      RowBox[{"p", ",", "d", ",", "e"}], "]"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"BdotBIF", "[", 
    RowBox[{"p_", ",", "d_", ",", "e_"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"p", "*", "1", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"c1B", "[", 
         RowBox[{"p", ",", "d", ",", "e"}], "]"}], "^", "2"}], "+", 
       RowBox[{
        RowBox[{"c2B", "[", 
         RowBox[{"p", ",", "d", ",", "e"}], "]"}], "^", "2"}]}], ")"}], "*", 
     RowBox[{"Kp", "[", 
      RowBox[{"p", ",", "d", ",", "e"}], "]"}]}], "+", 
    RowBox[{"1", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"c3B", "[", 
           RowBox[{"p", ",", "d", ",", "e"}], "]"}]}], ")"}], "^", "2"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"-", 
          RowBox[{"c3B", "[", 
           RowBox[{"p", ",", "d", ",", "e"}], "]"}]}], ")"}], "^", "2"}]}], 
      ")"}], "*", 
     RowBox[{"Km", "[", 
      RowBox[{"p", ",", "d", ",", "e"}], "]"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"CdotCIF", "[", 
    RowBox[{"p_", ",", "d_", ",", "e_"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"p", "*", "1", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"c1C", "[", 
         RowBox[{"p", ",", "d", ",", "e"}], "]"}], "^", "2"}], "+", 
       RowBox[{
        RowBox[{"c2C", "[", 
         RowBox[{"p", ",", "d", ",", "e"}], "]"}], "^", "2"}]}], ")"}], "*", 
     RowBox[{"Kp", "[", 
      RowBox[{"p", ",", "d", ",", "e"}], "]"}]}], "+", 
    RowBox[{"1", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"-", 
          RowBox[{"c3C", "[", 
           RowBox[{"p", ",", "d", ",", "e"}], "]"}]}], ")"}], "^", "2"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"c3C", "[", 
           RowBox[{"p", ",", "d", ",", "e"}], "]"}]}], ")"}], "^", "2"}]}], 
      ")"}], "*", 
     RowBox[{"Km", "[", 
      RowBox[{"p", ",", "d", ",", "e"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AdotBIF", "[", 
    RowBox[{"p_", ",", "d_", ",", "e_"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"p", "*", "1", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"c1A", "[", 
         RowBox[{"p", ",", "d", ",", "e"}], "]"}], "*", 
        RowBox[{"c1B", "[", 
         RowBox[{"p", ",", "d", ",", "e"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"c2A", "[", 
         RowBox[{"p", ",", "d", ",", "e"}], "]"}], "*", 
        RowBox[{"c2B", "[", 
         RowBox[{"p", ",", "d", ",", "e"}], "]"}]}]}], ")"}], "*", 
     RowBox[{"Kp", "[", 
      RowBox[{"p", ",", "d", ",", "e"}], "]"}]}], "+", 
    RowBox[{"1", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"-", 
          RowBox[{"c3A", "[", 
           RowBox[{"p", ",", "d", ",", "e"}], "]"}]}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"c3B", "[", 
           RowBox[{"p", ",", "d", ",", "e"}], "]"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"-", 
          RowBox[{"c3A", "[", 
           RowBox[{"p", ",", "d", ",", "e"}], "]"}]}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"-", 
          RowBox[{"c3B", "[", 
           RowBox[{"p", ",", "d", ",", "e"}], "]"}]}], ")"}]}]}], ")"}], "*", 
     RowBox[{"Km", "[", 
      RowBox[{"p", ",", "d", ",", "e"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AdotCIF", "[", 
    RowBox[{"p_", ",", "d_", ",", "e_"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"p", "*", "1", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"c1A", "[", 
         RowBox[{"p", ",", "d", ",", "e"}], "]"}], "*", 
        RowBox[{"c1C", "[", 
         RowBox[{"p", ",", "d", ",", "e"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"c2A", "[", 
         RowBox[{"p", ",", "d", ",", "e"}], "]"}], "*", 
        RowBox[{"c2C", "[", 
         RowBox[{"p", ",", "d", ",", "e"}], "]"}]}]}], ")"}], "*", 
     RowBox[{"Kp", "[", 
      RowBox[{"p", ",", "d", ",", "e"}], "]"}]}], "+", 
    RowBox[{"1", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"-", 
          RowBox[{"c3A", "[", 
           RowBox[{"p", ",", "d", ",", "e"}], "]"}]}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"-", 
          RowBox[{"c3C", "[", 
           RowBox[{"p", ",", "d", ",", "e"}], "]"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"-", 
          RowBox[{"c3A", "[", 
           RowBox[{"p", ",", "d", ",", "e"}], "]"}]}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"c3C", "[", 
           RowBox[{"p", ",", "d", ",", "e"}], "]"}]}], ")"}]}]}], ")"}], "*", 
     RowBox[{"Km", "[", 
      RowBox[{"p", ",", "d", ",", "e"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BdotCIF", "[", 
     RowBox[{"p_", ",", "d_", ",", "e_"}], "]"}], ":=", " ", 
    RowBox[{
     RowBox[{"p", "*", "1", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"c1B", "[", 
          RowBox[{"p", ",", "d", ",", "e"}], "]"}], "*", 
         RowBox[{"c1C", "[", 
          RowBox[{"p", ",", "d", ",", "e"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"c2B", "[", 
          RowBox[{"p", ",", "d", ",", "e"}], "]"}], "*", 
         RowBox[{"c2C", "[", 
          RowBox[{"p", ",", "d", ",", "e"}], "]"}]}]}], ")"}], "*", 
      RowBox[{"Kp", "[", 
       RowBox[{"p", ",", "d", ",", "e"}], "]"}]}], "+", 
     RowBox[{"1", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"c3B", "[", 
            RowBox[{"p", ",", "d", ",", "e"}], "]"}]}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"-", 
           RowBox[{"c3C", "[", 
            RowBox[{"p", ",", "d", ",", "e"}], "]"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"-", 
           RowBox[{"c3B", "[", 
            RowBox[{"p", ",", "d", ",", "e"}], "]"}]}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"c3C", "[", 
            RowBox[{"p", ",", "d", ",", "e"}], "]"}]}], ")"}]}]}], ")"}], "*", 
      RowBox[{"Km", "[", 
       RowBox[{"p", ",", "d", ",", "e"}], "]"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AIFEM", "[", 
     RowBox[{"p_", ",", "d_", ",", "e_"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"AdotAIF", "[", 
         RowBox[{"p", ",", "d", ",", "e"}], "]"}], ",", 
        RowBox[{"AdotBIF", "[", 
         RowBox[{"p", ",", "d", ",", "e"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"AdotBIF", "[", 
         RowBox[{"p", ",", "d", ",", "e"}], "]"}], ",", 
        RowBox[{"BdotBIF", "[", 
         RowBox[{"p", ",", "d", ",", "e"}], "]"}]}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Arelative", "[", 
     RowBox[{"p_", ",", "d_", ",", "e_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"AIFEM", "[", 
      RowBox[{"p", ",", "d", ",", "e"}], "]"}], ".", 
     RowBox[{"Inverse", "[", 
      RowBox[{"ASTAR", "[", 
       RowBox[{"p", ",", "d", ",", "e"}], "]"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Releigen", "[", 
     RowBox[{"p_", ",", "d_", ",", "e_"}], "]"}], ":=", 
    RowBox[{"Max", "[", 
     RowBox[{"Eigenvalues", "[", 
      RowBox[{"Arelative", "[", 
       RowBox[{"p", ",", "d", ",", "e"}], "]"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"FindMaxValue", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Releigen", "[", 
         RowBox[{"100", ",", "d", ",", "e"}], "]"}], ",", 
        RowBox[{
         RowBox[{"d", "\[GreaterEqual]", "0"}], " ", "&&", " ", 
         RowBox[{
          RowBox[{"1", "-", "d"}], "\[GreaterEqual]", "0"}], " ", "&&", " ", 
         RowBox[{"e", "\[GreaterEqual]", "0"}], " ", "&&", " ", 
         RowBox[{
          RowBox[{"1", "-", "e"}], "\[GreaterEqual]", "0"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"d", ",", "e"}], "}"}]}], "]"}], ";"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Plot3D", "[", 
    RowBox[{
     RowBox[{"Max", "[", 
      RowBox[{"Eigenvalues", "[", 
       RowBox[{"Arelative", "[", 
        RowBox[{"10", ",", "d", ",", "e"}], "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"d", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"e", ",", "0", ",", "1"}], "}"}]}], "]"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"M", "=", "0"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"d", "=", "0.02"}], ",", 
       RowBox[{"d", "<", "1"}], ",", 
       RowBox[{"d", "=", 
        RowBox[{"d", "+", "0.02"}]}], ",", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"e", "=", "0.02"}], ",", 
         RowBox[{"e", "<", "1"}], ",", 
         RowBox[{"e", "=", 
          RowBox[{"e", "+", "0.02"}]}], ",", 
         RowBox[{"M", "=", 
          RowBox[{"Max", "[", 
           RowBox[{"M", ",", 
            RowBox[{"Max", "[", 
             RowBox[{"Eigenvalues", "[", 
              RowBox[{"Arelative", "[", 
               RowBox[{"1000000", ",", "d", ",", "e"}], "]"}], "]"}], "]"}]}],
            "]"}]}]}], "]"}]}], "]"}], "\[IndentingNewLine]", "M"}]}], "*)"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Eigenmax", "[", "p_", "]"}], ":=", 
   RowBox[{"NMaximize", "[", 
    RowBox[{
     RowBox[{"Releigen", "[", 
      RowBox[{"p", ",", "d", ",", "e"}], "]"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"d", ",", "e"}], "}"}], "\[Element]", 
      RowBox[{"Rectangle", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}]}], "]"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.768001376472953*^9, 3.768001383325249*^9}, {
   3.7680014183766365`*^9, 3.768001423096481*^9}, {3.768001609846023*^9, 
   3.7680018801544027`*^9}, {3.768002030720734*^9, 3.7680021231051164`*^9}, {
   3.768002157955612*^9, 3.7680022884612703`*^9}, {3.7680024920965757`*^9, 
   3.7680025309682584`*^9}, {3.7680042977327185`*^9, 
   3.7680043285041113`*^9}, {3.768004568287508*^9, 3.7680045960954905`*^9}, {
   3.7680046296300316`*^9, 3.768004682035117*^9}, {3.768004922416874*^9, 
   3.7680050203632574`*^9}, {3.768005276389266*^9, 3.7680052937688828`*^9}, {
   3.768005422253364*^9, 3.768005438159074*^9}, {3.7680056112365117`*^9, 
   3.7680056737840405`*^9}, 3.7680074626898746`*^9, {3.768007509272997*^9, 
   3.7680075418161116`*^9}, {3.7680075749721346`*^9, 3.76800771306597*^9}, {
   3.7680079087838044`*^9, 3.7680079928313513`*^9}, {3.7680082079554214`*^9, 
   3.7680082588470664`*^9}, {3.7680083761270742`*^9, 3.768008466081772*^9}, {
   3.7680085683947635`*^9, 3.768008676393268*^9}, {3.768008801425609*^9, 
   3.768008872034148*^9}, {3.768010025237157*^9, 3.768010172872359*^9}, {
   3.7680102100541363`*^9, 3.768010257174205*^9}, {3.76801030686473*^9, 
   3.768010325784232*^9}, {3.7680103572500596`*^9, 3.768010577243864*^9}, {
   3.7680111873419704`*^9, 3.7680114080063615`*^9}, {3.768011457382929*^9, 
   3.768011458894314*^9}, {3.7680652609943256`*^9, 3.7680653301912374`*^9}, {
   3.768065400935851*^9, 3.7680655013146224`*^9}, {3.7680655885666714`*^9, 
   3.768065727713438*^9}, 3.768065760124236*^9, {3.768065801405388*^9, 
   3.7680659843173943`*^9}, {3.768066191869413*^9, 3.7680663119325647`*^9}, {
   3.768066351324902*^9, 3.7680666343525267`*^9}, {3.768066768541452*^9, 
   3.7680668678347273`*^9}, 3.7680669078733587`*^9, {3.7680669653159437`*^9, 
   3.7680670374850616`*^9}, {3.768067068163454*^9, 3.768067151077901*^9}, {
   3.7680672226754627`*^9, 3.768067252890356*^9}, {3.7680672887818966`*^9, 
   3.768067341843109*^9}, {3.768067372327591*^9, 3.768067373265107*^9}, {
   3.768067443482946*^9, 3.768067444757615*^9}, {3.768072821763797*^9, 
   3.768072940990925*^9}, {3.7680729876780186`*^9, 3.7680730562329035`*^9}, {
   3.768073088264551*^9, 3.7680730895621824`*^9}, {3.7680731558113675`*^9, 
   3.768073160136012*^9}, {3.76807320263315*^9, 3.768073230656084*^9}, {
   3.7680732653722644`*^9, 3.7680732847871075`*^9}, {3.7680733276012397`*^9, 
   3.7680733533209887`*^9}, {3.768073423826724*^9, 3.7680734906992273`*^9}, {
   3.768073535064173*^9, 3.7680735865607595`*^9}, {3.7680736187013474`*^9, 
   3.768073842227329*^9}, {3.7680739532468147`*^9, 3.7680739823788195`*^9}, {
   3.7680740213439484`*^9, 3.7680741603746214`*^9}, 3.768074200991335*^9, {
   3.7680742845324764`*^9, 3.76807441578032*^9}, {3.7680744697382183`*^9, 
   3.76807455958464*^9}, {3.7680746038965416`*^9, 3.768074734668831*^9}, {
   3.768075540043159*^9, 3.7680755502111044`*^9}, {3.76807561456567*^9, 
   3.768075625711192*^9}, 3.7680756578004665`*^9, {3.7680756960412626`*^9, 
   3.7680758451266565`*^9}, {3.7680759064155884`*^9, 
   3.7680759072752266`*^9}, {3.768075952795806*^9, 3.7680760114823875`*^9}, {
   3.76807606293071*^9, 3.768076063165154*^9}, {3.7680761262229214`*^9, 
   3.7680762791753407`*^9}, {3.768076318824429*^9, 3.7680763652413225`*^9}, {
   3.768076402421189*^9, 3.768076429080341*^9}, {3.768076462562231*^9, 
   3.768076480932648*^9}, {3.7681558941012964`*^9, 3.7681558998124866`*^9}, {
   3.768157258550011*^9, 3.7681572772868376`*^9}, {3.768160027405654*^9, 
   3.76816014469275*^9}, {3.7681602786106462`*^9, 3.768160352448265*^9}, {
   3.7681604393820243`*^9, 3.7681607629450417`*^9}, {3.7681611142490673`*^9, 
   3.7681611325052137`*^9}, {3.76816123627835*^9, 3.768161282296962*^9}},
 FontSize->9,ExpressionUUID->"d1949baf-33df-45d1-9fac-d99cb3b781f5"]
},
WindowSize->{1264, 637},
WindowMargins->{{-8, Automatic}, {Automatic, 0}},
Magnification:>1.2 Inherited,
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 47131, 1385, 1441, "Input",ExpressionUUID->"d1949baf-33df-45d1-9fac-d99cb3b781f5"]
}
]
*)

